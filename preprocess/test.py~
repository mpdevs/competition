import MySQLdb
import pandas as pd
import numpy as np
from glob import glob



host='192.168.1.31'
user='mpdev'
pwd='mpdev@2016'
industry = 'mp_women_clothing'

connect_industry = MySQLdb.Connect(host=host, user=user, passwd=pwd, db=industry, charset='utf8')
all_data = pd.read_sql_query("SELECT TaggedItemAttr as label, ItemID as itemid, ShopId as shopid, DiscountPrice, CategoryID FROM "+table_from+" WHERE TaggedItemAttr IS NOT NULL;", connect_industry)

for path in glob(paths):
    t = np.loadtxt(path, dtype=int, delimiter='\t')
    with open(path, 'w') as f:
        for line in t:
            f.writelines('\t'.join([str(line[0]), str(line[1]), ' ', ' ', all_data['label'][all_data == line[0]], all_data['label'][all_data == line[1]], str(line[2])]) + '\n')
            
